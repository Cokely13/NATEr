generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Category {
  Coding
  Study
  Work
  Reading
  Exercise
  Music
  Cleaning
  Stretching
  Walk
  Other
}

enum Frequency {
  Daily
  Weekly
  OneTime
}

model User {
  id        Int     @id @default(autoincrement())
  name      String
  email     String? @unique
  password  String
  goals     Goal[]
  progress  GoalProgress[]
}

model Goal {
  id              Int      @id @default(autoincrement())
  category        Category
  description     String?
  targetMinutes   Int
  frequency       Frequency
  date            DateTime?
  userId          Int
  user            User     @relation(fields: [userId], references: [id])
  progressEntries GoalProgress[]
    currentCompletedStreak Int      @default(0)
  currentMissedStreak    Int      @default(0)
  longestCompletedStreak Int      @default(0)
  longestMissedStreak    Int      @default(0)
}

model GoalProgress {
  id               Int      @id @default(autoincrement())
  goalId           Int
  userId           Int
  date             DateTime
  minutesCompleted Int
  completed        Boolean  @default(false)
  targetMinutes    Int

  goal             Goal     @relation(fields: [goalId], references: [id])
  user             User     @relation(fields: [userId], references: [id])
  @@unique([goalId, userId, date])
}
